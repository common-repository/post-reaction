{"version":3,"file":"public.js","mappings":"yBAEAA,OAAOC,UAAUC,OAAM,SAAUC,GAoB/B,IAAMC,EAAeH,SAASI,cAAc,kBAE5CF,EAAE,2BAA2BG,GAAG,SAAS,WAAY,IAAAC,EAAA,KAG/CC,EAAUL,EAAEM,MAAMC,KAAK,WACvBC,EAAkBR,EAAEM,MAAMC,KAAK,iBACnCP,EAAEM,MAAMG,SAASC,SAAS,YAG1BV,EAAEW,KAAK,CACLC,KAAM,OACNC,IAAKC,gBAAgBC,QACrBR,KAAM,CACJS,OAAQ,uBACRX,QAAAA,EACAY,cAAeT,EACfU,MAAOJ,gBAAgBI,OAEzBC,QAAS,SAACC,GAGR,IAAKA,EAASD,QAQZ,OAPAlB,EAAaoB,UAAYD,EAASb,KAClCN,EAAaqB,WAAWC,MAAMC,QAAU,OAExCC,YAAW,WACTxB,EAAaqB,WAAWC,MAAMC,QAAU,MAC1C,GAAG,UACHxB,EAAEI,GAAMK,SAASiB,YAAY,YAI/B,IACE1B,EAAEI,GACCK,SACAkB,KAAK,MACLC,KAAI,SAACC,EAAOC,GACX,IAAMb,EAAgBjB,EAAE8B,GAASvB,KAAK,iBACtCP,EAAEI,GAAMK,SAASkB,KAAK,0BAADI,OAA2Bd,EAAa,iCAAgCe,KAAKZ,EAASb,KAAK0B,MAAMhB,IAClHA,IAAkBT,GAAoBR,EAAEI,GAAM8B,SAAS,eAIzDC,QAAQC,IAAI,gBACZpC,EAAE8B,GAASJ,YAAY,gBAJvBS,QAAQC,IAAInB,EAAeT,GAC3BR,EAAE8B,GAASpB,SAAS,cAKxB,GACJ,CAAE,MAAO2B,GACPF,QAAQE,MAAMA,EAChB,CACArC,EAAEI,GAAMK,SAASiB,YAAY,WAC/B,EACAW,MAAO,SAACA,GACNrC,EAAEI,GAAMK,SAASiB,YAAY,YAC7BS,QAAQC,IAAIC,EAAMC,QACpB,GAGJ,GACF,G","sources":["webpack://BBlockSDK/./src/public.js"],"sourcesContent":["import \"./public.scss\";\r\n\r\njQuery(document).ready(function ($) {\r\n  // set reaction cookie\r\n  // function setReactionCookie(postId) {\r\n  //   const cookieName = `postReaction_${postId}`;\r\n  //   const expirationDate = new Date();\r\n  //   expirationDate.setDate(expirationDate.getDate() + 365); // Cookie expires in 1 year\r\n  //   document.cookie = `${cookieName}=true; expires=${expirationDate.toUTCString()}; path=/`;\r\n  //   localStorage.setItem(cookieName, true);\r\n  // }\r\n\r\n  // check if visitor already reacted\r\n  // function hasReacted(postId) {\r\n  //   const cookieName = `postReaction_${postId}`;\r\n\r\n  //   if (document.cookie.includes(cookieName) || localStorage.getItem(cookieName)) {\r\n  //     return true;\r\n  //   }\r\n  //   return false;\r\n  // }\r\n\r\n  const alertElement = document.querySelector(\".cprAlert span\");\r\n\r\n  $(\".post-reactions-list li\").on(\"click\", function () {\r\n    // console.log(\"clicked\", alertElement);\r\n\r\n    var post_id = $(this).data(\"post-id\");\r\n    var active_reaction = $(this).data(\"reaction-type\");\r\n    $(this).parent().addClass(\"disabled\");\r\n    // console.log(active_reaction);\r\n\r\n    $.ajax({\r\n      type: \"POST\",\r\n      url: postReactScript.ajaxURL,\r\n      data: {\r\n        action: \"update_post_reaction\",\r\n        post_id,\r\n        reaction_type: active_reaction,\r\n        nonce: postReactScript.nonce\r\n      },\r\n      success: (response) => {\r\n        // console.log(response);\r\n        // return;\r\n        if (!response.success) {\r\n          alertElement.innerText = response.data;\r\n          alertElement.parentNode.style.display = \"flex\";\r\n          // console.log(\"error\", alertElement);\r\n          setTimeout(() => {\r\n            alertElement.parentNode.style.display = \"none\";\r\n          }, 4000);\r\n          $(this).parent().removeClass(\"disabled\");\r\n          return;\r\n        }\r\n\r\n        try {\r\n          $(this)\r\n            .parent()\r\n            .find(\"li\")\r\n            .map((index, element) => {\r\n              const reaction_type = $(element).data(\"reaction-type\");\r\n              $(this).parent().find(`li[data-reaction-type=\"${reaction_type}\"] span:not(.prc_react_icon)`).html(response.data.count[reaction_type]);\r\n              if (reaction_type === active_reaction && !$(this).hasClass(\"reacted_to\")) {\r\n                console.log(reaction_type, active_reaction);\r\n                $(element).addClass(\"reacted_to\");\r\n              } else {\r\n                console.log(\"remove class\");\r\n                $(element).removeClass(\"reacted_to\");\r\n              }\r\n            });\r\n        } catch (error) {\r\n          console.error(error);\r\n        }\r\n        $(this).parent().removeClass(\"disabled\");\r\n      },\r\n      error: (error) => {\r\n        $(this).parent().removeClass(\"disabled\");\r\n        console.log(error.message);\r\n      },\r\n    });\r\n    // }\r\n  });\r\n});\r\n"],"names":["jQuery","document","ready","$","alertElement","querySelector","on","_this","post_id","this","data","active_reaction","parent","addClass","ajax","type","url","postReactScript","ajaxURL","action","reaction_type","nonce","success","response","innerText","parentNode","style","display","setTimeout","removeClass","find","map","index","element","concat","html","count","hasClass","console","log","error","message"],"sourceRoot":""}